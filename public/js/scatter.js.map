{"version":3,"sources":["scatter.js"],"names":["$","drawCircle","school_id","data","svg","selectAll","remove","enter","append","attr","d","x","avg_star","y","concussions2015","style","sel","d3","select","this","moveToFront","on","tip","show","hide","fullWidth","fullHeight","window_width","window","width","margin","top","right","bottom","left","height","scaleLinear","range","offset","mouse","html","name","call","csv","error","domain","extent","nice","max","axisBottom","text","axisLeft","selectize","options","maxItems","labelField","searchField","sortField","valueField","onChange","id","console","log","allowEmptyOption","placeholder","selection","prototype","each","parentNode","appendChild"],"mappings":"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","file":"scatter.js","sourcesContent":["$(function() {\n\nvar window_width = $(window).width();\nvar fullWidth;\nvar fullHeight;\n\n// responsive\nif (window_width >= 650){\n  fullWidth = 600;\n  fullHeight = 500;\n} else if (window_width <= 350) {\n  fullWidth = 290;\n  fullHeight = 290;\n} else {\n  fullWidth = window_width - 50;\n  fullHeight = fullWidth - 50;\n}\n\nvar margin = {top: 30, right: 20, bottom: 40, left: 40},\n    width = fullWidth - margin.left - margin.right,\n    height = fullHeight - margin.top - margin.bottom;\n\nvar x = d3.scaleLinear()\n    .range([0,width]);\n\nvar y = d3.scaleLinear()\n    .range([height,0]);\n\nvar svg = d3.select('#scatterplot').append(\"svg\")\n    .attr(\"width\", width + margin.left + margin.right)\n    .attr(\"height\", height + margin.top + margin.bottom)\n  .append(\"g\")\n    .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n// tooltip\nvar tip = d3.tip()\n  .attr('class', 'd3-tip')\n  .offset(function(){\n      if (d3.mouse(this)[0] < 100){\n        return [-10,100];\n      } else if (d3.mouse(this)[0] < fullWidth -50 && d3.mouse(this)[0] > fullWidth - 150 ){\n        return [-10, -100];\n      } else if (d3.mouse(this)[1] < 50){\n        return [80, 0];\n      } else {\n        return [-10, 0];\n      }\n  })\n  .html(function(d) {\n    return \"<strong>\" + d.name + \"</strong><br>Rating: \" + d.avg_star +\n            \"</br>Concussions: \" + d.concussions2015 ;\n  });\nsvg.call(tip);\n\n\nd3.csv('js/concussionsbyschool.csv', function(d){\n  d.avg_star = +d.avg_star;\n  d.concussions2015 = +d.concussions2015;\n  d.name = d.name;\n  d.school_id = d.school_id;\n  return d;\n}, function(error, data){\n  if (error) throw error;\n\n  x.domain(d3.extent(data, function(d) {return d.avg_star;})).nice();\n  y.domain([0, d3.max(data, function(d) {return d.concussions2015 + 2;})]);\n\n  // x and y axes\n  svg.append(\"g\")\n      .attr(\"class\", \"axis\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(d3.axisBottom(x))\n    .append(\"text\")\n      .attr(\"class\", \"axis-title\")\n      .attr('x', width)\n      .attr(\"y\", 25)\n      .attr(\"dy\", \".71em\")\n      .style(\"text-anchor\", \"end\")\n      .text(\"Average Helmet Rating\");\n\n  svg.append(\"g\")\n      .attr(\"class\", \"axis\")\n      .call(d3.axisLeft(y))\n    .append(\"text\")\n      .attr(\"class\", \"axis-title\")\n      .attr('x', -40)\n      .attr(\"y\", -20)\n      .attr(\"dy\", \".71em\")\n      .style(\"text-anchor\", \"start\")\n      .text(\"Concussions\");\n\n  drawCircle(0, data);\n\n    $('#school').selectize({\n      options: data,\n      maxItems: 1,\n      labelField: 'name',\n      searchField: 'name',\n      sortField: 'name',\n      valueField: 'school_id',\n      onChange: function(id) {\n          drawCircle(id, data);\n          console.log(id);\n      },\n      allowEmptyOption: true,\n      placeholder: 'Enter a school name to search'\n    });\n\n  // d3.select('#school').on('change', function() {\n  //   drawCircle(this.value, data);\n  // });\n\n});\n\nd3.selection.prototype.moveToFront = function() {\n  return this.each(function(){\n    this.parentNode.appendChild(this);\n  });\n};\n\nfunction drawCircle(school_id, data){\n  svg.selectAll('.dot').remove();\n  svg.selectAll('.dot')\n      .data(data)\n    .enter().append('circle')\n      .attr('class', 'dot')\n      .attr('r', 3.5)\n      .attr('cx', function(d) {return x(d.avg_star);})\n      .attr('cy', function(d) {return y(d.concussions2015);})\n      .style('fill', function(d){\n        if (d.school_id == school_id){\n          var sel = d3.select(this);\n          sel.moveToFront();\n          return 'white';\n        } else{\n          return '#ccc';\n        }\n      })\n      .style('stroke', function(d){\n        if (d.school_id == school_id){\n          var sel = d3.select(this);\n          sel.moveToFront();\n          return '#329ce8';\n        } else{\n          return '#ccc';\n        }\n      })\n      .style('stroke-width', function(d){\n        if (d.school_id == school_id){\n          var sel = d3.select(this);\n          sel.moveToFront();\n          return 3;\n        } else{\n          return 0;\n        }\n      })\n      .style('stroke-alignment', 'outer')\n      .on('mouseover', tip.show)\n      .on('mouseout', tip.hide);\n\n}\n});\n"],"sourceRoot":"/source/"}