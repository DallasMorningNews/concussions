{"version":3,"sources":["+custom.js","+searchable.js"],"names":["$","document","ready","d","Date","year","getFullYear","text","TDMN","Backbone","Marionette","_","schoolsCollection","Collection","helmetsCollection","SearchBoxView","ItemView","extend","collectionEvents","reset","template","onRender","self","this","selectize","options","collection","toJSON","maxItems","allowEmptyOption","placeholder","labelField","searchField","sortField","valueField","onChange","value","trigger","SchoolSearchView","el","CollectionView","select","childView","_selected","id","Number","render","filter","child","index","getJSON","data","helmets","schools","map","school","helmet","get","jQuery"],"mappings":"AAAAA,EAAAC,UAAAC,MAAA,WAOA,GAAAC,GAAA,GAAAC,MACAC,EAAAF,EAAAG,aAEAN,GAAA,cAAAO,KAAAF,KCVAG,QAEA,SAAAR,EAAAS,EAAAC,EAAAC,EAAAH,GAEA,YAGAA,GAAAI,kBAAA,GAAAH,GAAAI,WACAL,EAAAM,kBAAA,GAAAL,GAAAI,UAIA,IAAAE,GAAAL,EAAAM,SAAAC,QACAC,kBACAC,MAAA,UAGAC,SAAA,kBAEAC,SAAA,WACA,GAAAC,GAAAC,IAEAA,MAAAvB,EAAA,iBAAAwB,WACAC,QAAAF,KAAAG,WAAAC,SACAC,SAAA,EACAC,kBAAA,EACAC,YAAA,gCACAC,WAAA,OACAC,YAAA,OACAC,UAAA,OACAC,WAAA,KACAC,SAAA,SAAAC,GACAd,EAAAI,WAAAW,QAAA,SAAAD,SAaAE,GAPA,GAAAvB,IACAwB,GAAA,cAEAb,WAAAlB,EAAAI,oBAIAF,EAAA8B,eAAAvB,QACAsB,GAAA,kBAEArB,kBACAuB,OAAA,UAGAC,UAAAhC,EAAAM,SAAAC,QACAG,SAAA,wBAGAuB,UAAA,KAEAF,OAAA,SAAAG,GACArB,KAAAoB,UAAAE,OAAAD,GACArB,KAAAuB,UAGAC,OAAA,SAAAC,EAAAC,EAAAvB,GACA,MAAAsB,GAAAJ,KAAArB,KAAAoB,aAIA,IAAAL,IACAZ,WAAAlB,EAAAI,mBAKAZ,GAAAkD,QAAA,eAAA,SAAAC,GACA3C,EAAAM,kBAAAK,MAAAgC,EAAAC,SAIAD,EAAAE,QAAAC,IAAA,SAAAC,GAKA,MAJAA,GAAAH,QAAAzC,EAAA2C,IAAAC,EAAAH,QAAA,SAAAI,GAEA,MADAA,GAAAA,OAAAhD,EAAAM,kBAAA2C,IAAAD,EAAAA,QAAA7B,SACA6B,IAEAD,IAGA/C,EAAAI,kBAAAO,MAAAgC,EAAAE,YAIAK,OAAAjD,SAAAC,WAAAC,EAAAH","file":"scripts-bundle.js","sourcesContent":["$(document).ready(function() {\n\n\t//custom scripting goes here\n\t\n\t// injecting current year into footer\n\t// DO NOT DELETE\n\n\tvar d = new Date();\n\tvar year = d.getFullYear();\n\n\t$('.copyright').text(year);\n\n\n\t// some code blocks require javascript to function, like slideshows, synopsis blocks, etc\n\t// you can find that code here: https://github.com/DallasMorningNews/generator-dmninteractives/wiki/Cookbook\n\n\n\n});\n","TDMN = {};\n\n(function($, Backbone, Marionette, _, TDMN) {\n\n  'use strict';\n\n  // Data models\n  TDMN.schoolsCollection = new Backbone.Collection();\n  TDMN.helmetsCollection = new Backbone.Collection();\n\n\n  // Views\n  var SearchBoxView = Marionette.ItemView.extend({\n    collectionEvents: {\n      reset: 'render'\n    },\n\n    template: '#tpl-search-box',\n\n    onRender: function() {\n      var self = this;\n\n      this.$('#search-input').selectize({\n        options: this.collection.toJSON(),\n        maxItems: 1,\n        allowEmptyOption: true,\n        placeholder: 'Enter a school name to search',\n        labelField: 'name',\n        searchField: 'name',\n        sortField: 'name',\n        valueField: 'id',\n        onChange: function(value) {\n          self.collection.trigger('select', value);\n        }\n      });\n    }\n  });\n\n  var searchBox = new SearchBoxView({\n    el: '#search-box',\n\n    collection: TDMN.schoolsCollection,\n  });\n\n\n  var SchoolSearchView = Marionette.CollectionView.extend({\n    el: '#search-results',\n\n    collectionEvents: {\n      select: 'select'\n    },\n\n    childView: Marionette.ItemView.extend({\n      template: '#tpl-search-results'\n    }),\n\n    _selected: null,\n\n    select: function(id) {\n      this._selected = Number(id);\n      this.render();\n    },\n\n    filter: function(child, index, collection) {\n      return child.id === this._selected;\n    }\n  });\n\n  var schoolSearchView = new SchoolSearchView({\n    collection: TDMN.schoolsCollection\n  });\n\n\n  // Fetch and bootstrap collections\n  $.getJSON('js/data.json', function(data) {\n    TDMN.helmetsCollection.reset(data.helmets);\n\n    // Add helmets info to the schools so we can easily render it in the\n    // templates\n    data.schools.map(function(school) {\n      school.helmets = _.map(school.helmets, function(helmet) {\n        helmet.helmet = TDMN.helmetsCollection.get(helmet.helmet).toJSON();\n        return helmet;\n      });\n      return school;\n    });\n\n    TDMN.schoolsCollection.reset(data.schools);\n  });\n\n\n})(jQuery, Backbone, Marionette, _, TDMN);\n"],"sourceRoot":"/source/"}